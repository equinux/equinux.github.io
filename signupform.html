
  <!-- CSS -->
  <style type="text/css">
    #md365-signup {
      background: #ffffff00;
      font: 14px Arial, Helvetica, sans-serif;
      padding-top: 5px;
      padding-bottom: 5px;
    }
  
    .md365-form form {
      display: block;
      position: relative;
      text-align: center
    }
    
    .md365-h3 h3 {
      font-weight: bold;
      padding: 0;
      margin: 15px 0;
      font-size: 1.3em;
      text-align: center;
      color: #757578;
    }
    
    .md365-input-wrapper {
      text-align: center;
      display: flex;
    }
  
    .md365-input-wrapper input {
      vertical-align: bottom;
      margin: 5px;
      padding: 0 10px;
      outline: none;
      font-size: 14px !important;
      font-weight: normal;
      border-radius: 4px;
      flex-grow: 1;
    }
  
    .md365-input-wrapper input[type="submit"] {
      border: 1px solid;
      transition: all 0.20s ease-in-out 0s;
      color: #757578;
      background-color: #FFFFFF;
      cursor: pointer;
      height: 39px;
      min-width: 100px;
      max-width: 30%;
      text-align: center;
      margin: auto;
      margin-top: 5px;
    }
  
    .md365-input-wrapper input[type="text"],
    [type="email"] {
      height: 39px;
      background-color: #eee;
      border: 1px solid;
      border-color: #ffffff00;
      transition: all 0.20s ease-in-out 0s;
    }

    .hidden {
      display: none;
    }
  
  </style>
  <!-- We recommend to move the style block into the HEAD of the HTML file. -->
  <!-- HTML -->
  <div id="md365-signup">
    <form class="md365-form" action="http://localhost:5000/public/api/signup/68612d48-d312-4a85-900d-a1a6864921a5" method="post" id="md365-subscribe-form" name="subscribe-form" target="_blank">
      <div id="md365-form">
        <span class="md365-h3"><h3>HelloSeasons</h3></span>
          <div class="md365-input-wrapper">
          <input class="md365-input" type="text" name="firstname" id="md365-firstName"
            placeholder="First name" autocomplete="given-name">
        </div>
        <div class="md365-input-wrapper">
          <input class="md365-input" type="text" name="lastname" id="md365-lastName"
            placeholder="Last name" autocomplete="family-name">
        </div>
        <div class="md365-input-wrapper">
          <input class="md365-input" type="email" name="email" id="md365-email"
            placeholder="Email *" autocomplete="email" required>
            </div>
            <fieldset>
            <legend>Subscribe to: </legend>
              <div class="col">
    <input type="checkbox" name= attributes value= AutumnCollection id="md365-Autumn-AutumnCollection-STRING"/>
    <label for="AutumnCollection"> AutumnCollection</label>
  </div>  <div class="col">
    <input type="checkbox" name= attributes value= WinterCollection id="md365-Winter-WinterCollection-STRING"/>
    <label for="WinterCollection"> WinterCollection</label>
  </div>
            </fieldset>
            </div>
            <input class="md365-end" autocomplete="off" type="text" id="nameAlt" name="nameAlt" placeholder="Your name here">
            <input class="md365-end" autocomplete="off" type="text" id="emailAlt" name="emailAlt" placeholder="Your email here">
            <br />
            <div class="row">
        
        </div>
        <div class="md365-input-wrapper">
          <input class="md365-button" type="submit" value="submit" name="subscribe"
        id="md365-subscribe">
        </div>
        <div>
          <input class="md365-redirectURL" style="display: none;" type="text" name="url" value="
          " id="md365-redirectURL">
          <input class="md365-confirmationSuccessURL" style="display: none;" type="text" name="confirmation_success_url" value="" id="md365-confirmationSuccessURL">
          <input class="md365-confirmationFailureURL" style="display: none;" type="text" name="confirmation_failure_url" value="" id="md365-confirmationFailureURL" autocomplete="off">
          <input class="md365-signupFormId" style="display: none;" type="text" name="signupFormId" value="79d4c7e3-8a61-4884-8cc8-4aaa8a33adc3" id="md365-signupFormId" autocomplete="off">
        </div>
      </div>
      
  <span class="md365-h3 hidden" id="success-message">
    <h3> Sign up was successful. Please confirm your email address. </h3>
  </span>
    </form>
  </div>
  <!-- JavaScript -->
  <script>
  const formToJSON = elements => {
    const newAttributes = [];
  const attributes = document.getElementsByName('attributes');
  attributes.forEach((attribute) => {
    if (attribute.checked) {
      attributeArray = attribute.id.split('-');
      newAttributes.push([attributeArray[1], attributeArray[2], attributeArray[3]]);
    };
            });
  const dataReduced = [].reduce.call(
    elements,
    (data, element) => {
      if (element.name !== 'attributes' && element.name !== '') {
      data[element.name] = element.value;
      }
      data['attributes'] = {...newAttributes}
      return data;
    }, {}
  );
  return dataReduced
} 

document.getElementById('md365-subscribe-form').addEventListener(
  "submit",
  function(evt) {
    evt.preventDefault();
    const form = document.getElementsByClassName('md365-form')[0];
    const data = formToJSON(form.elements);
    var request = new XMLHttpRequest(); 
    request.open(
      'POST',
      'http://localhost:5000/public/api/signup/68612d48-d312-4a85-900d-a1a6864921a5'
    );
    request.setRequestHeader('Content-Type', 'application/json');
    request.send(JSON.stringify(data));
    request.addEventListener('load', function(event) {
      if (request.status >= 200 && request.status < 300) {
        if (document.getElementById('success-message') != null) {
        document.getElementById("success-message").classList.remove('hidden')
        } else {
        var el = document.getElementById("failure-message");
        el.innerHTML = `  <span class="md365-h3" id="success-message"><h3>${formatMessage(messages.successfulSubmit)}</h3></span>`
        }
      } else if(request.status == 400 || request.status == 500 || request.status == 409)  {
        if (document.getElementById('success-message') != null) {
        var el = document.getElementById('success-message');
        var newEl = document.createElement('p');
        var response = JSON.parse(request.responseText);
        newEl.innerHTML =  ` <span class="md365-h3" id="failure-message"><h3>${response.error}</h3></span>`;
        el.parentNode.replaceChild(newEl, el);
        } else {
          var response = JSON.parse(request.responseText);
          var el = document.getElementById('failure-message');
          el.innerHTML =  ` <span class="md365-h3" id="failure-message"><h3>${response.error}</h3></span>`;
        }
      } else {
        var response = JSON.parse(request.responseText);
        alert(response.error);
      }
    });
    request.addEventListener('error', function(event) {
      var response = JSON.parse(request.responseText);
      alert(response.error);
    });
  });
</script>